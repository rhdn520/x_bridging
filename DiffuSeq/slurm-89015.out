Logging to /tmp/openai-2025-11-19-21-24-41-907290
diffusion_models/diffuseq_qqp_h128_lr0.0001_t2000_sqrt_lossaware_seed102_test-qqp20251007-00:59:04/training_args.json
Namespace(model_path='diffusion_models/diffuseq_qqp_h128_lr0.0001_t2000_sqrt_lossaware_seed102_test-qqp20251007-00:59:04/ema_0.9999_010000.pt', step=2000, out_dir='generation_outputs', top_p=-1, lr=0.0001, batch_size=50, microbatch=64, learning_steps=10000, log_interval=20, save_interval=10000, eval_interval=1000, ema_rate='0.9999', resume_checkpoint='none', schedule_sampler='lossaware', diffusion_steps=2000, noise_schedule='sqrt', timestep_respacing='', vocab='bert', use_plm_init='no', vocab_size=30522, config_name='bert-base-uncased', notes='test-qqp20251007-00:59:04', data_dir='/home/seungwoochoi/data/x_bridging/DiffuSeq/datasets/CommonsenseConversation', dataset='qqp', checkpoint_path='diffusion_models/diffuseq_qqp_h128_lr0.0001_t2000_sqrt_lossaware_seed102_test-qqp20251007-00:59:04', seq_len=128, hidden_t_dim=128, hidden_dim=128, dropout=0.1, use_fp16=False, fp16_scale_growth=0.001, seed=102, gradient_clipping=-1.0, weight_decay=0.0, learn_sigma=False, use_kl=False, predict_xstart=True, rescale_timesteps=True, rescale_learned_sigmas=False, sigma_small=False, emb_scale_factor=1.0, split='test', clamp_step=0, seed2=123, clip_denoised=False)
### Creating model and diffusion...
config:::
BertConfig {
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "transformers_version": "4.57.1",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

0it [00:00, ?it/s]0it [00:00, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data6/seungwoochoi/x_bridging/DiffuSeq/text_interpolation.py", line 355, in <module>
[rank0]:     main()
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/x_bridging/DiffuSeq/text_interpolation.py", line 265, in main
[rank0]:     x_start = model.get_cls_conditioned_embeds(text_token)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/x_bridging/DiffuSeq/diffuseq/transformer_model.py", line 116, in get_cls_conditioned_embeds
[rank0]:     last_hidden_state = self.input_transformers(word_embedding).last_hidden_state[:,0,:]
[rank0]:                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/models/bert/modeling_bert.py", line 650, in forward
[rank0]:     layer_outputs = layer_module(
[rank0]:                     ^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/modeling_layers.py", line 94, in __call__
[rank0]:     return super().__call__(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/models/bert/modeling_bert.py", line 558, in forward
[rank0]:     self_attention_outputs = self.attention(
[rank0]:                              ^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/models/bert/modeling_bert.py", line 488, in forward
[rank0]:     self_outputs = self.self(
[rank0]:                    ^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/transformers/models/bert/modeling_bert.py", line 231, in forward
[rank0]:     query_layer = self.query(hidden_states)
[rank0]:                   ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 134, in forward
[rank0]:     return F.linear(input, self.weight, self.bias)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: RuntimeError: mat1 and mat2 shapes cannot be multiplied (6x128 and 768x768)
[rank0]:[W1119 21:24:44.337918048 ProcessGroupNCCL.cpp:1524] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
E1119 21:24:44.903000 321015 site-packages/torch/distributed/elastic/multiprocessing/api.py:882] failed (exitcode: 1) local_rank: 0 (pid: 321036) of binary: /data6/seungwoochoi/.conda/envs/x_bridging/bin/python3.11
Traceback (most recent call last):
  File "/data6/seungwoochoi/.conda/envs/x_bridging/bin/torchrun", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 357, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/distributed/run.py", line 936, in main
    run(args)
  File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/distributed/run.py", line 927, in run
    elastic_launch(
  File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 156, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data6/seungwoochoi/.conda/envs/x_bridging/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 293, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
text_interpolation.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-11-19_21:24:44
  host      : n01
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 321036)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
